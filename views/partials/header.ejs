<nav class="navbar">
    <div class="nav-container">
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" id="mobileMenuToggle">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Logo -->
        <div class="nav-logo">
            <a href="/">
                <img src="/assets/logo.svg" alt="Hymns Logo" class="logo">
                <span>Hymns</span>
            </a>
        </div>
        
        <!-- Search Bar -->
        <div class="nav-search">
            <form action="/search" method="GET">
                <div class="search-box">
                    <input type="text" name="q" placeholder="Search hymns..." id="search-input">
                    <button type="submit"><i class="fas fa-search"></i></button>
                </div>
            </form>
        </div>
        
        <!-- Main Navigation Menu -->
        <div class="nav-menu" id="navMenu">
            <a href="/" class="nav-link">Home</a>
            
            <!-- Languages Dropdown -->
            <div class="nav-dropdown">
                <a href="#" class="nav-link">
                    Languages <i class="fas fa-chevron-down"></i>
                </a>
                <div class="dropdown-content">
                    <a href="/amharic/worship">Amharic</a>
                    <a href="/oromo/worship">Afan Oromo</a>
                    <a href="/tigrigna/worship">Tigrigna</a>
                    <a href="/english/worship">English</a>
                </div>
            </div>
            
            <!-- User-specific links -->
            <% if (user && user.isAdmin) { %>
                <a href="/admin" class="nav-link">Admin</a>
            <% } %>
            
            <% if (user) { %>
                <a href="/users/profile" class="nav-link">Profile</a>
                <a href="/users/logout" class="nav-link">Logout</a>
            <% } else { %>
                <a href="/users/login" class="nav-link">Login</a>
                <a href="/users/register" class="nav-link btn-primary">Sign Up</a>
            <% } %>
        </div>
    </div>
</nav>

<script>
// Mobile menu functionality
document.addEventListener('DOMContentLoaded', function() {
    const mobileToggle = document.getElementById('mobileMenuToggle');
    const navMenu = document.getElementById('navMenu');
    const navDropdowns = document.querySelectorAll('.nav-dropdown');
    
    // Mobile menu toggle
    if (mobileToggle && navMenu) {
        mobileToggle.addEventListener('click', function(e) {
            e.stopPropagation();
            navMenu.classList.toggle('active');
            this.classList.toggle('active');
            
            // Toggle icon between bars and times
            const icon = this.querySelector('i');
            if (icon.classList.contains('fa-bars')) {
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-times');
            } else {
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
        });
        
        // Close menu when clicking outside
        document.addEventListener('click', function(e) {
            if (!navMenu.contains(e.target) && !mobileToggle.contains(e.target)) {
                navMenu.classList.remove('active');
                mobileToggle.classList.remove('active');
                
                // Reset icon to bars
                const icon = mobileToggle.querySelector('i');
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
        });
        
        // Close menu when clicking on a link (for single page navigation)
        navMenu.addEventListener('click', function(e) {
            if (e.target.tagName === 'A' || e.target.parentElement.tagName === 'A') {
                navMenu.classList.remove('active');
                mobileToggle.classList.remove('active');
                
                // Reset icon to bars
                const icon = mobileToggle.querySelector('i');
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
        });
    }
    
    // Mobile dropdown functionality
    navDropdowns.forEach(dropdown => {
        const link = dropdown.querySelector('.nav-link');
        const dropdownContent = dropdown.querySelector('.dropdown-content');
        
        link.addEventListener('click', function(e) {
            if (window.innerWidth <= 768) {
                e.preventDefault();
                e.stopPropagation();
                
                // Close other dropdowns
                navDropdowns.forEach(otherDropdown => {
                    if (otherDropdown !== dropdown) {
                        otherDropdown.classList.remove('active');
                    }
                });
                
                // Toggle current dropdown
                dropdown.classList.toggle('active');
            }
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!dropdown.contains(e.target)) {
                dropdown.classList.remove('active');
            }
        });
    });
    
    // Handle window resize
    window.addEventListener('resize', function() {
        if (window.innerWidth > 768) {
            // Reset mobile menu state on desktop
            if (navMenu) navMenu.classList.remove('active');
            if (mobileToggle) {
                mobileToggle.classList.remove('active');
                const icon = mobileToggle.querySelector('i');
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
            
            // Close all dropdowns on desktop
            navDropdowns.forEach(dropdown => {
                dropdown.classList.remove('active');
            });
        }
    });
});
</script>